<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Admin Panel</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="../bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link href="../fontsv5/css/fontawesome.min.css" rel="stylesheet">
  <link href="../fontsv5/css/brands.min.css" rel="stylesheet">
  <link href="../fontsv5/css/solid.min.css" rel="stylesheet">
  <!-- Theme style -->
  <link rel="stylesheet" href="../dist/css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="../dist/css/skins/_all-skins.css">
  <!-- DataTable -->
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.css">  
  <!-- header fixed-->
  <link rel="stylesheet" href="../stylesheets/utils.css">

</head>

<body class="hold-transition skin-purple sidebar-mini">
<!-- Site wrapper -->

    <!-- Header -->
    <% include include/header.ejs %>
    <!-- Left Panel -->
    <% include include/leftpanel.ejs %>

  <!-- =============================================== -->

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper" id="mywrapper" style="overflow-y: auto; overflow-x: hidden;">
    <div class=" row col-lg-12 col-lg-offset-1">

      <div class=" container col-lg-10   ">
        <h1 class="well" align="center">Reporte de Votación</h1>

        <div class=" row col-lg-12 col-lg-offset-1">
        <div class=" container col-lg-10   ">

            <h1 class="well" align="center">Resultados Votación-Asamblea Universitaria</h1>
            <table class="table table-striped table-condensed " id="tabla_asamblea"  > <!--table-condensed-->
                <thead  class="bg-primary" >
                  <tr  id="tabla_asamblea_head" >
                    <th ><p align="center">#</p></th>
                    <th ><p align="center">Facultades</p></th>
                  </tr>
                </thead>
                <tbody align="center">
                 
                </tbody>
            </table>

            <h2 class="well" align="center">Puestos-Asamblea Universitaria</h2>
            <table class="table table-striped table-condensed " id="tabla_asamblea_ranking"  > <!--table-condensed-->
                <thead  class="bg-primary" >
                  <tr>
                    <th ><p align="center">Puesto</p></th>
                    <th ><p align="center">Lista</p></th>
                    <th ><p align="center">Representación</p></th>
                    <th ><p align="center">Total Votos</p></th>
                  </tr>
                </thead>
                <tbody align="center">
                 
                </tbody>
            </table>

            <h1 class="well" align="center">Resultados Consejo de Facultad</h1>
            <div id="container_facultades"> </div>

            <!-- h2 class="well" align="center">Facultad de Ciencias Biologicas </h2>
            <table class="table table-striped table-condensed " id="tabla_ciencias_biologicas_ranking" 
              <thead  class="bg-primary" >
                <tr>
                  <th ><p align="center">Puesto</p></th>
                  <th ><p align="center">Lista</p></th>
                  <th ><p align="center">Representación</p></th>
                  <th ><p align="center">Total Votos</p></th>
                </tr>
              </thead>
              <tbody align="center">
              </tbody>
            </table -->

            


        </div>
      </div>   
  </div>
  <!-- /.content-wrapper -->


  <% include include/footer.ejs %>

  


  <!-- jQuery 2.2.3 -->
  <script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
  <!-- Bootstrap 3.3.6 -->
  <script src="../bootstrap/js/bootstrap.min.js"></script>
  <!-- DataTable -->
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.js"></script>

  
  <!-- AdminLTE App -->
  <script src="../dist/js/app.min.js"></script>
  <!-- Color Picker -->
  <!--script src="../js/jscolor.js"></script-->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@9"></script>
  



<!--Pagination datatable-->

<!--script src="https://cdn.datatables.net/1.10.19/js/dataTables.bootstrap.min.js"></script> 

<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script> 

<link src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"> 
<link src="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" rel="stylesheet"> 
<script src="https://code.jquery.com/jquery-3.3.1.js"></script--> 

<script>
//var select_process;
$(document).ready(function() {
  //alert("loading data");
  //load_resultados_asamblea();
  //load_resultados_asamblea_ranking();

  load_facultades();
  //load_resultados_ciencia_biologica_ranking();
  //load_resultados_administracion_ranking();
  //load_resultados_ing_procesos_ranking();

});

function load_facultades(){
  //console.log("get facultades");

  $.get("/admin/get_facultades_ranking", function(data, status){
    
    var container = $('#container_facultades');
    console.log(data);
    data.forEach(function (facultad) {

        container.append("<h3 class='well' align='center'>" + facultad.nombre + "</h3>");

        /*
        var i = 1;
        $.get("/admin/ciencias-biologicas-ranking", function(data, status){
          console.log("data ",data);
          var code = `   
        <table class="table table-striped table-condensed ">
              <thead  class="bg-primary" >
                <tr>
                  <th ><p align="center">Puesto</p></th>
                  <th ><p align="center">Lista</p></th>
                  <th ><p align="center">Representación</p></th>
                  <th ><p align="center">Total Votos</p></th>
                </tr>
              </thead>
              <tbody align="center">`;
          data.forEach(function (puesto) {
            code+= "<tr><td>" + i + "</td><td>" + puesto.nombre + "</td><td>"+ puesto.representacion + "</td><td>"+ puesto.total +"</td></tr>";
            code+= "</tbody></table>";
            //container.append();
            i++;
          });
        });*/

        //container.append(code);   
    });
    
    //console.log(data);
  });

}

function load_resultados_ciencia_biologica_ranking(){
  //console.log("RANKING");
  var table = $('#tabla_ciencias_biologicas_ranking');
  $.get("/admin/ciencias-biologicas-ranking", function(data, status){
    var i = 1;
    data.forEach(function (puesto) {
      table.append("<tr><td>" + i + "</td><td>" + puesto.nombre + "</td><td>"+ puesto.representacion + "</td><td>"+ puesto.total+"</td><tr>");
      i++;
    });    
  });
}


function load_resultados_asamblea_ranking(){
  //console.log("RANKING");
  var table = $('#tabla_asamblea_ranking');
  $.get("/admin/votacion-ranking", function(data, status){
    //console.log(data);
    var i = 1;
    var total_nulo_blanco = 0;
    data.forEach(function (puesto) {
      if(puesto.nombre != "VOTO BLANCO" && puesto.nombre != "VOTO NULO"){
        table.append("<tr><td>" + i + "</td><td>" + puesto.nombre + "</td><td>"+ puesto.representacion + "</td><td>"+ puesto.total+"</td></tr>");
        i++;
      }else{
        total_nulo_blanco+=parseInt(puesto.total);
      }
    });
    table.append("<tr><td> </td><td> VOTO BLANCO/NULO </td><td>  </td><td>"+ total_nulo_blanco +"</td></tr>");
  });
}




function init_head_asamblea(listas){
  var table_head = $('#tabla_asamblea_head');
  listas.forEach(function (lista) {
    table_head.append(" <th ><p align='center'>"+lista.nombre+"</p></th>");
  }); 
  table_head.append(" <th ><p align='center'> TOTAL VOTOS EMITIDOS </p></th>");
  table_head.append(" <th ><p align='center'> TOTAL VOTOS HABILITADOS </p></th>");


}

function load_resultados_asamblea(){

      
  $.get("/admin/votacion-asamblea", function(data, status){
    
    //console.log(votaciones_fac);
    var table = $('#tabla_asamblea');
    
    init_head_asamblea(data.listas);
    
    var votos_fac = data.votos_fac;
    //console.log(votos_fac);
    
    var total_votos_listas = [];
    //initilize list votos
    data.listas.forEach(function(list){
      total_votos_listas.push(0);
    });
    //console.log("total_votos_listas:",total_votos_listas);
    
    var i=1;

    var total_votos_emitidos = 0;
    var acum_total_votos_habilitados = 0;

    votos_fac.forEach(function(votos){
      //console.log(votos);
      var row = "<tr><td>" + i + "</td><td>" + votos.nombre_fac + "</td>";
        var pos=0;
        var total_votos_fac = 0;
        votos.votos.forEach(function (voto){
          row += "<td>"+voto.total+ "</td>";
          total_votos_fac+=parseInt(voto.total);
          total_votos_listas[pos]+=parseInt(voto.total);
          pos++;
          //console.log(voto);  
        });
        row += "<td>"+total_votos_fac+ "</td>";
        row += "<td>"+votos.habilitados+ "</td>";
        row+=+"</td></tr>";
        total_votos_emitidos += total_votos_fac;
        acum_total_votos_habilitados += parseInt(votos.habilitados);
        //votos.habilitados + "</td><td>"+ asistencia.asistentes +"</td><td>"+ asistencia.porcentaje+'%' +"</td><tr>");
      i++;

      table.append(row);
    });

    var row = "<tr><td>" + "</td><td> TOTAL VOTANTES </td>";
    total_votos_listas.forEach(function(total){
      row+="<td>"+ total+"</td>"
    });
    row+="<td>"+ total_votos_emitidos +"</td>"
    row+="<td>"+ acum_total_votos_habilitados+"</td>"
    row+="</tr>"
    table.append(row); 
  });
  
}

</script>



</body>
</html>

<style>
thead input {
        width: 100%;
    }

</style>



